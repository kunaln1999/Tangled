<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contact us — Tangled</title>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="Images/tangled-spiral-favicon.png">
  <link rel="shortcut icon" type="image/png" href="Images/tangled-spiral-favicon.png">
  <link rel="apple-touch-icon" href="Images/tangled-spiral-favicon.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="global.css">
</head>

<body class="page-contact">
  <!-- Header widget mount -->
  <div id="app-header-mount"></div>

  <main class="page-main">
    <!-- Contact page content -->
    <section class="contact-hero">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="support.html">Support Centre</a>
        <span class="sep">›</span>
        <span aria-current="page">Contact us</span>
      </nav>
      <h1>Contact us</h1>
      <p>Questions, feedback, or partnership ideas? Send us a note and we’ll get back to you.</p>
    </section>

    <section class="contact-grid">
      <!-- Left: Form -->
      <div class="card form-card">
        <header>
          <h2>Send a message</h2>
        </header>
        <form id="contact-form" novalidate>
          <div class="form-grid">
            <div class="form-row">
              <label for="ct-first-name">First name</label>
              <input class="ui-input" id="ct-first-name" name="first_name" type="text" required maxlength="40"
                autocomplete="given-name" />
            </div>
            <div class="form-row">
              <label for="ct-last-name">Last name</label>
              <input class="ui-input" id="ct-last-name" name="last_name" type="text" required maxlength="40"
                autocomplete="family-name" />
            </div>
            <div class="form-row">
              <label for="ct-email">Your email</label>
              <input class="ui-input" id="ct-email" name="email" type="email" required />
            </div>
            <div class="form-row">
              <label for="ct-category">Category</label>
              <div class="ui-select-wrap" data-select id="ct-category" role="combobox" aria-haspopup="listbox"
                aria-expanded="false" aria-owns="ct-category-menu">
                <button type="button" class="select-trigger" data-select-trigger aria-controls="ct-category-menu">
                  <span class="placeholder">Choose a category</span>
                </button>
                <svg class="select-caret" viewBox="0 0 24 24" aria-hidden="true">
                  <polyline points="6,9 12,15 18,9" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round"></polyline>
                </svg>
                <div class="select-menu" id="ct-category-menu" role="listbox" tabindex="-1">
                  <div class="select-option" role="option" data-value="Login / OTP">Login / OTP</div>
                  <div class="select-option" role="option" data-value="Plans &amp; Billing">Plans &amp; Billing</div>
                  <div class="select-option" role="option" data-value="Boost">Boost</div>
                  <div class="select-option" role="option" data-value="Messages &amp; Matches">Messages &amp; Matches
                  </div>
                  <div class="select-option" role="option" data-value="Privacy &amp; Data">Privacy &amp; Data</div>
                  <div class="select-option" role="option" data-value="Safety &amp; Reporting">Safety &amp; Reporting
                  </div>
                  <div class="select-option" role="option" data-value="Other">Other</div>
                </div>
                <input type="hidden" name="category" value="">
              </div>
            </div>
            <div class="form-row" style="grid-column: 1 / -1;">
              <label for="ct-subject">Subject</label>
              <input class="ui-input" id="ct-subject" name="subject" type="text" required maxlength="120" />
            </div>
            <div class="form-row" style="grid-column: 1 / -1;">
              <label for="ct-details">Details</label>
              <textarea class="ui-textarea" id="ct-details" name="details" required maxlength="1000"></textarea>
            </div>
            <div class="form-row" style="grid-column: 1 / -1;">
              <label>Attachment</label>
              <div class="attach-ui" data-attach>
                <input id="ct-attach" name="attach" type="file" accept="image/*,video/*,.txt,.log,.pdf" multiple
                  hidden />
                <button type="button" class="attach-trigger" data-attach-btn>
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" fill="none"
                      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path d="M14 2v6h6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round"></path>
                    <path d="M12 11v6M9 14h6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round"></path>
                  </svg>
                  Choose file
                </button>
                <div class="attach-drop" tabindex="0" aria-label="Drop a file here">Drag &amp; drop a screenshot or log
                  here</div>
                <div class="attach-preview" aria-live="polite"></div>
              </div>
            </div>
          </div>


          <div class="actions">
            <button type="submit" class="btn btn-primary" id="submit-btn">Send message</button>
          </div>
        </form>
      </div>

    </section>
  </main>

  <!-- Footer widget mount -->
  <div id="app-footer-mount"></div>

  <script>
    fetch('index.html')
      .then(r => r.text())
      .then(html => {
        const doc = new DOMParser().parseFromString(html, 'text/html');
        // Ensure logo sprite is present for <use href="#logo-tangled">
        if (!document.getElementById('logo-tangled')) {
          const sprite = doc.querySelector('svg symbol#logo-tangled');
          if (sprite) {
            const svgWrap = document.createElement('svg');
            svgWrap.setAttribute('aria-hidden', 'true');
            svgWrap.setAttribute('focusable', 'false');
            svgWrap.setAttribute('width', '0');
            svgWrap.setAttribute('height', '0');
            svgWrap.setAttribute('style', 'position:absolute; width:0; height:0; overflow:hidden');
            svgWrap.appendChild(sprite.cloneNode(true));
            document.body.insertBefore(svgWrap, document.body.firstChild);
          }
        }
        const headerTpl = doc.getElementById('app-header-template');
        const footerTpl = doc.getElementById('app-footer-template');

        const headerMount = document.getElementById('app-header-mount');
        if (headerTpl && headerMount) {
          const frag = headerTpl.content.cloneNode(true);
          headerMount.replaceWith(frag);
        }
        const footerMount = document.getElementById('app-footer-mount');
        if (footerTpl && footerMount) {
          const frag = footerTpl.content.cloneNode(true);
          footerMount.replaceWith(frag);
        }

        // After mounting, wire up the header hamburger just like on index.html
        (function () {
          function toggleHeader(expand, header, btn) {
            if (!header) return;
            const willExpand = (typeof expand === 'boolean') ? expand : !header.classList.contains('expanded');
            header.classList.toggle('expanded', willExpand);
            if (btn) {
              btn.classList.toggle('is-open', willExpand);
              btn.setAttribute('aria-expanded', willExpand ? 'true' : 'false');
            }
          }

          // Event delegation so it works even if header is mounted later from template
          document.addEventListener('click', function (e) {
            const btn = e.target.closest('.hamburger');
            if (!btn) return;
            const header = btn.closest('.site-header') || document.querySelector('.site-header');
            toggleHeader(undefined, header, btn);
          }, true);

          // Close expanded state when resizing to desktop
          let lastWidth = window.innerWidth;
          window.addEventListener('resize', function () {
            const now = window.innerWidth;
            if (lastWidth !== now) {
              if (now > 980) {
                document.querySelectorAll('.site-header.expanded').forEach(function (h) {
                  h.classList.remove('expanded');
                  const b = h.querySelector('.hamburger');
                  if (b) { b.classList.remove('is-open'); b.setAttribute('aria-expanded', 'false'); }
                });
              }
              lastWidth = now;
            }
          });
        })();

        // Update footer year if present
        (function () {
          var y = document.getElementById('year');
          if (y) { y.textContent = String(new Date().getFullYear()); }
        })();
      });
  </script>
  <script>
    (function () {
      const sel = (s, r = document) => r.querySelector(s);

      // Inline validation (custom messages) for required fields — no native bubbles
      (function () {
        const FIELDS = [
          { id: '#ct-first-name', msg: 'Please enter your first name.' },
          { id: '#ct-last-name', msg: 'Please enter your last name.' },
          { id: '#ct-email', msg: 'Please enter your email address.' },
          { id: '#ct-subject', msg: 'Please add a short subject.' },
          { id: '#ct-details', msg: 'Please describe your message in a few lines.' }
        ];

        function getErrorNode(afterEl) {
          // Find an immediate sibling error node, else create one
          let n = afterEl.nextElementSibling;
          if (!(n && n.classList && n.classList.contains('field-error'))) {
            n = document.createElement('div');
            n.className = 'field-error';
            afterEl.insertAdjacentElement('afterend', n);
          }
          return n;
        }
        function showError(inputEl, message) {
          if (!inputEl) return;
          inputEl.classList.add('invalid');
          inputEl.setAttribute('aria-invalid', 'true');
          const errorEl = getErrorNode(inputEl);
          errorEl.textContent = message || '';
        }
        function clearError(inputEl) {
          if (!inputEl) return;
          inputEl.classList.remove('invalid');
          inputEl.removeAttribute('aria-invalid');
          const n = inputEl.nextElementSibling;
          if (n && n.classList && n.classList.contains('field-error')) n.textContent = '';
        }

        // Attach listeners to clear errors while typing
        FIELDS.forEach(({ id }) => {
          const el = sel(id);
          if (!el) return;
          ['input', 'change', 'blur'].forEach(ev => el.addEventListener(ev, () => { if (el.value && el.value.trim().length > 0) clearError(el); }));
          // prevent native bubble
          el.addEventListener('invalid', (e) => e.preventDefault());
        });

        // Email format check (simple)
        const emailEl = sel('#ct-email');
        function isValidEmail(v) { return /.+@.+\..+/.test(v); }
        if (emailEl) {
          emailEl.addEventListener('blur', () => {
            const v = emailEl.value.trim();
            if (v && !isValidEmail(v)) showError(emailEl, 'Please enter a valid email address.');
          });
        }

        // Expose validateAll for submit handler
        window.__contactValidate = function () {
          let firstInvalid = null;
          // Basic required checks
          FIELDS.forEach(({ id, msg }) => {
            const el = sel(id);
            if (!el) return;
            const val = (el.value || '').trim();
            if (!val) { showError(el, msg); if (!firstInvalid) firstInvalid = el; }
            else if (id === '#ct-email' && !isValidEmail(val)) { showError(el, 'Please enter a valid email address.'); if (!firstInvalid) firstInvalid = el; }
            else { clearError(el); }
          });


          // Category (custom select)
          const catWrap = document.querySelector('.ui-select-wrap[data-select]');
          const catHidden = catWrap ? catWrap.querySelector('input[type="hidden"]') : null;
          const catTrigger = catWrap ? catWrap.querySelector('[data-select-trigger]') : null;
          const ensureCatErr = () => {
            let n = catWrap && catWrap.nextElementSibling;
            if (!(n && n.classList && n.classList.contains('field-error'))) {
              n = document.createElement('div');
              n.className = 'field-error';
              if (catWrap) catWrap.insertAdjacentElement('afterend', n);
            }
            return n;
          };
          if (catHidden && (!catHidden.value || !catHidden.value.trim())) {
            if (catTrigger) catTrigger.classList.add('invalid');
            ensureCatErr().textContent = 'Please choose a category.';
            if (!firstInvalid && catTrigger) firstInvalid = catTrigger;
          } else {
            if (catTrigger) catTrigger.classList.remove('invalid');
            const n = catWrap && catWrap.nextElementSibling; if (n && n.classList && n.classList.contains('field-error')) n.textContent = '';
          }

          if (firstInvalid) { firstInvalid.focus({ preventScroll: true }); }
          // Return overall validity
          return !firstInvalid;
        };
      })();

      // Custom select (Category) — same behavior as support page
      (function () {
        const wrap = sel('.ui-select-wrap[data-select]');
        if (!wrap) return;
        const trigger = wrap.querySelector('[data-select-trigger]');
        const menu = wrap.querySelector('.select-menu');
        const hidden = wrap.querySelector('input[type="hidden"]');
        const options = Array.from(wrap.querySelectorAll('.select-option'));
        let currentIndex = -1;
        function open() {
          wrap.classList.add('open');
          wrap.setAttribute('aria-expanded', 'true');
          setTimeout(() => { menu && menu.focus({ preventScroll: true }); }, 0);
          document.addEventListener('mousedown', onDocClick);
          document.addEventListener('keydown', onKey);
        }
        function close() {
          wrap.classList.remove('open');
          wrap.setAttribute('aria-expanded', 'false');
          document.removeEventListener('mousedown', onDocClick);
          document.removeEventListener('keydown', onKey);
          trigger && trigger.focus({ preventScroll: true });
        }
        function onDocClick(e) { if (!wrap.contains(e.target)) close(); }
        function choose(opt) {
          // Clear inline category error on choose
          const err = wrap.nextElementSibling; if (err && err.classList && err.classList.contains('field-error')) err.textContent = '';
          if (trigger) trigger.classList.remove('invalid');
          options.forEach(o => o.removeAttribute('aria-selected'));
          opt.setAttribute('aria-selected', 'true');
          const text = opt.textContent.trim();
          hidden.value = opt.getAttribute('data-value') || text;
          trigger.innerHTML = text;
        }
        function onKey(e) {
          if (!wrap.classList.contains('open')) return;
          if (e.key === 'Escape') close();
          if (e.key === 'ArrowDown') { e.preventDefault(); currentIndex = Math.min(options.length - 1, Math.max(0, currentIndex + 1)); options[currentIndex].focus && options[currentIndex].focus(); menu.scrollTop = options[currentIndex].offsetTop - 40; }
          if (e.key === 'ArrowUp') { e.preventDefault(); currentIndex = Math.max(0, (currentIndex < 0 ? 0 : currentIndex - 1)); options[currentIndex].focus && options[currentIndex].focus(); menu.scrollTop = options[currentIndex].offsetTop - 40; }
          if (e.key === 'Enter') { e.preventDefault(); const opt = options[currentIndex] || options[0]; if (opt) { choose(opt); close(); } }
        }
        trigger.addEventListener('click', () => { wrap.classList.contains('open') ? close() : open(); });
        options.forEach((opt) => {
          opt.setAttribute('tabindex', '0');
          opt.addEventListener('click', () => { choose(opt); close(); });
          opt.addEventListener('keydown', (e) => { if (e.key === 'Enter') { choose(opt); close(); } });
        });
      })();

      // Attachment UI — same constraints as support page (max 4, 1MB each), media previews 30×30, chips in one row
      (function () {
        const wrap = sel('[data-attach]');
        if (!wrap) return;
        const input = wrap.querySelector('#ct-attach');
        const btn = wrap.querySelector('[data-attach-btn]');
        const drop = wrap.querySelector('.attach-drop');
        const preview = wrap.querySelector('.attach-preview');
        const MAX_FILES = 4; const MAX_SIZE = 1024 * 1024;
        const selected = [];
        function toast(text) { try { const m = document.createElement('div'); m.textContent = text; m.style.position = 'fixed'; m.style.left = '50%'; m.style.bottom = '20px'; m.style.transform = 'translateX(-50%)'; m.style.background = 'var(--page)'; m.style.border = '1px solid var(--border)'; m.style.borderRadius = '12px'; m.style.padding = '10px 14px'; m.style.boxShadow = '0 4px 16px rgba(0,0,0,0.18)'; m.style.zIndex = '1001'; document.body.appendChild(m); setTimeout(() => m.remove(), 1800); } catch (e) { } }
        function fmt(bytes) { if (bytes < 1024) return bytes + ' B'; const kb = bytes / 1024; if (kb < 1024) return kb.toFixed(1) + ' KB'; return (kb / 1024).toFixed(2) + ' MB'; }
        function sync() { try { const dt = new DataTransfer(); selected.forEach(f => dt.items.add(f)); input.files = dt.files; } catch (e) { } }
        function render() {
          preview.innerHTML = ''; selected.forEach((file, idx) => {
            const chip = document.createElement('div'); chip.className = 'attach-file';
            let previewElem = null; if (file.type?.startsWith('image/')) { previewElem = document.createElement('img'); previewElem.src = URL.createObjectURL(file); Object.assign(previewElem.style, { width: '30px', height: '30px', objectFit: 'cover', borderRadius: '8px', display: 'block' }); previewElem.onload = () => URL.revokeObjectURL(previewElem.src); } else if (file.type?.startsWith('video/')) { previewElem = document.createElement('video'); previewElem.src = URL.createObjectURL(file); Object.assign(previewElem.style, { width: '30px', height: '30px', objectFit: 'cover', borderRadius: '8px', display: 'block' }); previewElem.muted = true; previewElem.playsInline = true; previewElem.addEventListener('loadedmetadata', () => { try { previewElem.play(); } catch (e) { } }); }
            const nameSpan = document.createElement('span'); const base = file.name || ''; const short = base.length > 30 ? base.slice(0, 27) + '...' : base; nameSpan.textContent = short + (file.size ? ' • ' + fmt(file.size) : '');
            const remove = document.createElement('button'); remove.type = 'button'; remove.className = 'attach-remove'; remove.setAttribute('aria-label', 'Remove file'); const remSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg'); remSvg.setAttribute('viewBox', '0 0 24 24'); remSvg.setAttribute('width', '16'); remSvg.setAttribute('height', '16'); const p1 = document.createElementNS('http://www.w3.org/2000/svg', 'polyline'); p1.setAttribute('points', '6,6 18,18'); p1.setAttribute('fill', 'none'); p1.setAttribute('stroke', 'currentColor'); p1.setAttribute('stroke-width', '2'); p1.setAttribute('stroke-linecap', 'round'); p1.setAttribute('stroke-linejoin', 'round'); const p2 = document.createElementNS('http://www.w3.org/2000/svg', 'polyline'); p2.setAttribute('points', '18,6 6,18'); p2.setAttribute('fill', 'none'); p2.setAttribute('stroke', 'currentColor'); p2.setAttribute('stroke-width', '2'); p2.setAttribute('stroke-linecap', 'round'); p2.setAttribute('stroke-linejoin', 'round'); remSvg.appendChild(p1); remSvg.appendChild(p2); remove.appendChild(remSvg); remove.addEventListener('click', () => { selected.splice(idx, 1); sync(); render(); });
            if (previewElem) { chip.appendChild(previewElem); } else { const icon = document.createElementNS('http://www.w3.org/2000/svg', 'svg'); icon.setAttribute('viewBox', '0 0 24 24'); icon.setAttribute('width', '16'); icon.setAttribute('height', '16'); const path = document.createElementNS('http://www.w3.org/2000/svg', 'path'); path.setAttribute('d', 'M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z'); path.setAttribute('fill', 'none'); path.setAttribute('stroke', 'currentColor'); path.setAttribute('stroke-width', '2'); path.setAttribute('stroke-linecap', 'round'); path.setAttribute('stroke-linejoin', 'round'); icon.appendChild(path); chip.appendChild(icon); }
            chip.appendChild(nameSpan); chip.appendChild(remove); preview.appendChild(chip);
          });
        }
        function add(list) { const files = Array.from(list || []); if (!files.length) return; const rej = []; files.forEach((f) => { if (f.size > MAX_SIZE) { rej.push(`"${f.name}" is larger than 1MB`); return; } if (selected.length >= MAX_FILES) { rej.push('Only up to ' + MAX_FILES + ' files allowed'); return; } const dup = selected.some(s => s.name === f.name && s.size === f.size); if (!dup) { selected.unshift(f); } }); if (rej.length) { toast(rej[0]); } sync(); render(); }
        btn?.addEventListener('click', () => input?.click());
        input?.addEventListener('change', () => add(input.files));
        function dragOn(e) { e.preventDefault(); e.stopPropagation(); drop?.classList.add('drag'); }
        function dragOff() { drop?.classList.remove('drag'); }
        // Minimal: bind drag & drop only on desktop; CSS hides the dropzone on smaller screens
        if (drop && window.innerWidth > 1024) {
          ['dragenter', 'dragover'].forEach(ev => drop.addEventListener(ev, dragOn));
          ['dragleave', 'dragend', 'drop'].forEach(ev => drop.addEventListener(ev, dragOff));
          drop.addEventListener('drop', (e) => { e.preventDefault(); add(e.dataTransfer && e.dataTransfer.files); });
        }
      })();

      // Submit (simulate)
      (function () {
        const form = sel('#contact-form');
        const submitBtn = sel('#submit-btn');
        if (!form) return;
        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          // ---- 12h rate-limit: 1 message per device OR per email ----
          const WINDOW_MS = 12 * 60 * 60 * 1000; // 12 hours
          const now = Date.now();
          const emailInput = sel('#ct-email');
          // Keys
          const DEV_KEY = 'ct_last_device_ts';
          // Helper functions
          function remainingTime(ts) {
            const ms = WINDOW_MS - (now - ts);
            if (ms <= 0) return '0m';
            const totalMin = Math.ceil(ms / 60000);
            const h = Math.floor(totalMin / 60);
            const m = totalMin % 60;
            return (h > 0 ? (h + 'h ') : '') + (m + 'm');
          }
          function toast(text) {
            try {
              const m = document.createElement('div');
              m.textContent = text;
              m.style.position = 'fixed';
              m.style.left = '50%';
              m.style.bottom = '20px';
              m.style.transform = 'translateX(-50%)';
              m.style.background = 'var(--page)';
              m.style.border = '1px solid var(--border)';
              m.style.borderRadius = '12px';
              m.style.padding = '10px 14px';
              m.style.boxShadow = '0 4px 16px rgba(0,0,0,0.18)';
              m.style.zIndex = '1001';
              document.body.appendChild(m);
              setTimeout(() => m.remove(), 2400);
            } catch (e) { }
          }
          // Our inline validation (no native bubbles)
          if (!window.__contactValidate || !window.__contactValidate()) return;
          // Recompute email and apply 12h rate limit AFTER validation
          const emailVal = (emailInput?.value || '').trim().toLowerCase();
          const EMAIL_KEY = emailVal ? ('ct_last_email_ts:' + emailVal) : null;
          const lastDeviceTs = Number(localStorage.getItem(DEV_KEY) || 0);
          const lastEmailTs = EMAIL_KEY ? Number(localStorage.getItem(EMAIL_KEY) || 0) : 0;
          const deviceBlocked = lastDeviceTs > 0 && (now - lastDeviceTs) < WINDOW_MS;
          const emailBlocked = lastEmailTs > 0 && (now - lastEmailTs) < WINDOW_MS;
          if (deviceBlocked || emailBlocked) {
            const remaining = deviceBlocked ? remainingTime(lastDeviceTs) : remainingTime(lastEmailTs);
            toast('You can send only one message every 12 hours. Please try again in ' + remaining + '.');
            if (emailInput) emailInput.focus({ preventScroll: true });
            return; // stop submit
          }
          submitBtn && (submitBtn.disabled = true);
          try {
            await new Promise(res => setTimeout(res, 600));
            // Show toast-style message instead of alert
            const m = document.createElement('div');
            m.textContent = 'Message sent successfully.';
            m.style.position = 'fixed';
            m.style.left = '50%';
            m.style.bottom = '20px';
            m.style.transform = 'translateX(-50%)';
            m.style.background = 'var(--page)';
            m.style.border = '1px solid var(--border)';
            m.style.borderRadius = '12px';
            m.style.padding = '10px 14px';
            m.style.boxShadow = '0 4px 16px rgba(0,0,0,0.18)';
            m.style.zIndex = '1001';
            document.body.appendChild(m);
            setTimeout(() => m.remove(), 1800);
            form.reset();
            // Persist rate-limit timestamps
            try {
              localStorage.setItem('ct_last_device_ts', String(Date.now()));
              if (emailVal) localStorage.setItem('ct_last_email_ts:' + emailVal, String(Date.now()));
            } catch (e) { }
          }
          catch (e) {
            console.error(e);
            alert('Something went wrong. Please try again.');
          }
          finally {
            submitBtn && (submitBtn.disabled = false);
          }
        });
      })();
    })();
  </script>
</body>

</html>